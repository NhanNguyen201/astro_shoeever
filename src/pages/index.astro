---
import { client } from "../helpers/sanityClient";
import RenderSections from '../components/RenderSections.astro'
import Layout from '../layouts/BaseLayout.astro';

import HomeHeroBanner from '../components/HomeHeroBanner.astro';
import groq from 'groq';
let data;
let homepageHeroBanner;
try {
    let result = await client.fetch(
            // Get the route document with one of the possible slugs for the given requested path
        groq`*[_type == "siteSettings"][0]{
              frontpageHeadHeroBanner,
              frontpage -> {
                  ...,
                  body[]{
                    ...
                  }
              }
          }`,
    );
    // console.log("result: ", result);
    data = result?.frontpage || {};  
    homepageHeroBanner = result?.frontpageHeadHeroBanner || null;
    // console.log("data: ", data)
} catch (error) {
  console.error("Error fetching page data:", error);
  homepageHeroBanner = null;
  
  data = {};
}
---

<Layout title={data.title} description={data.description} openGraphImage={data.openGraphImage}>
    {homepageHeroBanner && <Fragment slot="homepageHeroBanner"><HomeHeroBanner {...homepageHeroBanner} /></Fragment>}
    {data && <RenderSections sections={data.body}/>}
</Layout>